<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Linux使用expect,登录并同步文件</title>
    <link href="/2020/ec5147b2.html"/>
    <url>/2020/ec5147b2.html</url>
    
    <content type="html"><![CDATA[<p><strong>由于需要同步linux两端的文件，写了一个同步脚本！(此脚本也可用于vps静态部署hexo)。</strong></p><div class="hljs"><pre><code class="hljs bash"><span class="hljs-comment">#！ /bin/sh</span><span class="hljs-comment">#删除远程服务器文件</span><span class="hljs-function"><span class="hljs-title">deleteblog</span></span>()&#123;expect -c <span class="hljs-string">"</span><span class="hljs-string">spawn ssh -i /root/.ssh/id_rsa1 root@xxx.xxx.xxx.xxx rm -fr /var/www/*</span><span class="hljs-string">expect &#123;</span><span class="hljs-string">               yes/no &#123; send \"yes\r\"; exp_continue &#125;</span><span class="hljs-string">               passphrase* &#123; send \"123456\r\" &#125; #  123456 为秘钥密码</span><span class="hljs-string">   &#123; send \"exit\r\" &#125;</span><span class="hljs-string">           &#125;;</span><span class="hljs-string">expect eof</span><span class="hljs-string">       "</span>   &#125;<span class="hljs-comment">#将文件同步到远程服务器</span><span class="hljs-function"><span class="hljs-title">sendblog</span></span>()&#123;expect -c <span class="hljs-string">"   </span><span class="hljs-string">           set timeout -1</span><span class="hljs-string">           spawn scp -i /root/.ssh/id_rsa1 /date/dingblog.tar.gz  root@xxx.xxx.xxx.xxx:/var/www/</span><span class="hljs-string">           expect &#123;</span><span class="hljs-string">               yes/no &#123; send \"yes\r\"; exp_continue &#125;</span><span class="hljs-string">               passphrase* &#123; send \"123456\r\" &#125; #  123456 为秘钥密码</span><span class="hljs-string">   &#123; send \"exit\r\" &#125;</span><span class="hljs-string">           &#125;;</span><span class="hljs-string">           expect eof;</span><span class="hljs-string">       "</span>   &#125;<span class="hljs-comment">#解压远程服务器文件</span><span class="hljs-function"><span class="hljs-title">tarblog</span></span>()&#123;expect -c <span class="hljs-string">"   </span><span class="hljs-string">           spawn ssh -i /root/.ssh/id_rsa1 root@xxx.xxx.xxx.xxx tar zxvf /var/www/dingblog.tar.gz -C /var/www/</span><span class="hljs-string">           expect &#123;</span><span class="hljs-string">               yes/no &#123; send \"yes\r\"; exp_continue &#125;</span><span class="hljs-string">               passphrase* &#123; send \"123456\r\" &#125; #  123456 为秘钥密码</span><span class="hljs-string">   &#123; send \"exit\r\" &#125;</span><span class="hljs-string">           &#125;;</span><span class="hljs-string">           expect eof;</span><span class="hljs-string">       "</span>   &#125;deleteblogsendblogtarblog</code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>吉比特 wo-27s 光猫获取超密</title>
    <link href="/2020/ddc395d6.html"/>
    <url>/2020/ddc395d6.html</url>
    
    <content type="html"><![CDATA[<p>支持 <code>吉比特</code> 其他型号小伙伴可以自己测试。<br>1.光猫背面有光猫管理地址 如: 192.168.x.x 用户名及密码。用默认地址 和 用户名密码登录。</p><p>2.登录成功后直接输入 <code>http://192.168.x.x/dumpdatamodel.cgi</code></p><p>3.打开下载成功的文件，推荐使用 <code>notepad++</code>查找 <Account> 不出意外 第一个username就是超级用户名，web_passwd就是超级密码，这是我的:</p><p> <code>&lt;Account&gt;    &lt;Entry0Active=&quot;Yes&quot;username=&quot;lnadmin&quot;web_passwd=&quot;lnadmin0123456&quot;</code><br>然后就可以使用地址<code>http://192.168.x.x/cu.html</code> 登录啦！！！</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>友华PT622光猫获取超密</title>
    <link href="/2020/ee7d8191.html"/>
    <url>/2020/ee7d8191.html</url>
    
    <content type="html"><![CDATA[<p>支持 <code>友华 PT622</code> 、  <code>友华PT921G</code> 其他型号小伙伴可以自己测试。<br>1.光猫背面有光猫管理地址 如: 192.168.x.x 用户名及密码。用默认地址 和 用户名密码登录。</p><p>2.登录成功后直接输入 <code>http://192.168.x.x/romfile.cfg</code></p><p>3.打开下载成功的文件，推荐使用 <code>notepad++</code>查找 <Account> 不出意外 第一个username就是超级用户名，web_passwd就是超级密码，这是我的:</p><p> <code>&lt;Account&gt;    &lt;Entry0Active=&quot;Yes&quot;username=&quot;lnadmin&quot;web_passwd=&quot;lnadmin0123456&quot;</code><br>然后就可以使用地址<code>http://192.168.x.x/cu.html</code> 登录啦！！！</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Proxifier注册码</title>
    <link href="/2020/f53eb66d.html"/>
    <url>/2020/f53eb66d.html</url>
    
    <content type="html"><![CDATA[<p>Proxifier 注册码，亲测 3.4.2有效</p><p><code>L6Z8A-XY2J4-BTZ3P-ZZ7DF-A2Q9C（Portable Edition）</code></p><p><code>5EZ8G-C3WL5-B56YG-SCXM9-6QZAP（Standard Edition）</code></p><p><code>P427L-9Y552-5433E-8DSR3-58Z68（MAC）</code></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>MTU值的作用以及设置</title>
    <link href="/2020/a0a0f41d.html"/>
    <url>/2020/a0a0f41d.html</url>
    
    <content type="html"><![CDATA[<p>1、什么情况下需要改MTU？<br>　　如果您的动态域名网站不能被正常访问，很难连接，连接上也非常慢，请试试把DirectSend设为“总是关闭”。如果关闭后可以正常访问，这种情况就需要修改MTU。如果您的网站连接正常，只是下载速度慢，就不必改MTU了。请跳过这一节。</p><p>2、什么是MTU？<br>　　MTU是Maximum Transmission Unit的缩写。意思是网络上传送的最大数据包。MTU的单位是字节。<br>　　大部分网络设备的MTU都是1500。如果本机的MTU比网关的MTU大，大的数据包就会被拆开来传送，这样会产生很多数据包碎片，增加丢包率，降低网络速度。把本机的MTU设成比网关的MTU小或相同，就可以减少丢包。(但是我们平时宽带上网使用PPPoE协议最大是1492,因为在PPPoE协议中对数据重新封装,会产生8Byte的PPP包头包尾数据)</p><p>3、如何检测网关的MTU？<br>　　在本机打开dos窗口，执行：<br>　　　   <code>ping -f -l 1472 192.168.0.1</code><br>　　　　其中<code>192.168.0.1</code>是网关IP地址，1472是数据包的长度。请注意，上面的参数是“-l”（小写的L），而不是“-1”。<br>　　如果能ping通，表示数据包不需要拆包，可以通过网关发送出去。<br>　　如果出现：<br>　　　　<code>Packet needs to be fragmented but DF set.</code><br>　　表示数据包需要拆开来发送。此时，减少数据包长度，再执行上面的ping命令。从1400到1472之间多试几次，就能找到合适的数据包长度了。把数据包长度加上数据包头28字节，就得到MTU的值。<br>　　如果检测到网关的MTU值是1500，不需要修改。<br>　　如果网关有防火墙ping不通，可以试试直接把MTU设为1400。</p><p>4、如何修改本机的MTU？<br>　　修改方法如下：<br>（1）、运行regedit<br>（2）、浏览到：<br>　　<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</code><br>如图2<br>（3）、Interfaces下有多个子项，每个子项对应一个网卡。请按如下方法选择网卡：<br>　　（a）确定本机用来连接Internet的网卡或拨号连接的IP，如192.168.0.19；<br>　　（b）用鼠标点击Interfaces上的子项，查看键值列表中的IPAddress项；<br>　　（c）如果IPAddress的键值与（a）中的IP相同，即192.168.0.19，则该子项就是要找的网卡。<br>（4）、进入该子项，在右边的窗口里按鼠标右键，选择“新建”-&gt;“双字节值”，输入名称“MTU”，按回车。再用鼠标双击“MTU”，弹出修改窗口：<br>如图3：<br>　　填入MTU的值。填写前请先把基数设为十进制。<br>　　设置好后，需要重启机器才能生效。</p><p>如果在有交换机路由设备中出现传输故障,也要仔细查看配置MTU值是否一致或者符合传输要求.</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>V2RAY手动安装及简单配置</title>
    <link href="/2020/e68ed487.html"/>
    <url>/2020/e68ed487.html</url>
    
    <content type="html"><![CDATA[<h3 id="V2ray-安装及配置"><a href="#V2ray-安装及配置" class="headerlink" title="V2ray 安装及配置"></a>V2ray 安装及配置</h3><h4 id="V2ray-安装及配置-1"><a href="#V2ray-安装及配置-1" class="headerlink" title="V2ray 安装及配置"></a>V2ray 安装及配置</h4><h5 id="一键安装"><a href="#一键安装" class="headerlink" title="一键安装"></a>一键安装</h5><div class="hljs"><pre><code class="hljs bash">bash &lt;(curl -L -s https://install.direct/go.sh)</code></pre></div><p>######此脚本会自动安装以下文件：</p><ul><li><strong>/usr/bin/v2ray/v2ray：V2Ray 程序；</strong></li><li><strong>/usr/bin/v2ray/v2ctl：V2Ray 工具；</strong></li><li><strong>/etc/v2ray/config.json：配置文件；</strong></li><li><strong>/usr/bin/v2ray/geoip.dat：IP 数据文件</strong></li><li><strong>/usr/bin/v2ray/geosite.dat：域名数据文件</strong></li></ul><p>此脚本会配置自动运行脚本。自动运行脚本会在系统重启之后，自动运行 V2Ray。目前自动运行脚本只支持带有 Systemd 的系统，以及 Debian / Ubuntu 全系列。</p><p>运行脚本位于系统的以下位置：</p><p><code>/etc/systemd/system/v2ray.service: Systemd</code><br><code>/etc/init.d/v2ray: SysV</code><br>脚本运行完成后，你需要：</p><p>编辑<code>/etc/v2ray/config.json</code>文件来配置你需要的代理方式；<br>运行 <code>service v2ray start</code> 来启动 V2Ray 进程；<br>之后可以使用 <code>service v2ray start|stop|status|reload|restart|force-reload</code>控制 V2Ray 的运行。</p><h5 id="配置示范"><a href="#配置示范" class="headerlink" title="配置示范"></a>配置示范</h5><ul><li><strong>CADDY+ HTTP + V2RAY + TLS</strong><div class="hljs"><pre><code class="hljs json">&#123;    <span class="hljs-attr">"log"</span>: &#123;        <span class="hljs-attr">"access"</span>: <span class="hljs-string">"/var/log/v2ray/access.log"</span>,        <span class="hljs-attr">"error"</span>: <span class="hljs-string">"/var/log/v2ray/error.log"</span>,        <span class="hljs-attr">"loglevel"</span>: <span class="hljs-string">"none"</span>    &#125;,    <span class="hljs-attr">"stats"</span>: &#123;&#125;, <span class="hljs-attr">"policy"</span>: &#123;  <span class="hljs-attr">"system"</span>: &#123;   <span class="hljs-attr">"statsInboundDownlink"</span>: <span class="hljs-literal">true</span>,   <span class="hljs-attr">"statsInboundUplink"</span>: <span class="hljs-literal">true</span>  &#125;,  <span class="hljs-attr">"levels"</span>: &#123;   <span class="hljs-attr">"1"</span>: &#123;<span class="hljs-attr">"statsUserUplink"</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">"statsUserDownlink"</span>: <span class="hljs-literal">true</span>   &#125;  &#125; &#125;,    <span class="hljs-attr">"api"</span>: &#123;        <span class="hljs-attr">"services"</span>: [                <span class="hljs-string">"HandlerService"</span>,                <span class="hljs-string">"LoggerService"</span>,                <span class="hljs-string">"StatsService"</span>        ],        <span class="hljs-attr">"tag"</span>: <span class="hljs-string">"api"</span>        &#125;,        <span class="hljs-attr">"levels"</span>: &#123;            <span class="hljs-attr">"1"</span>: &#123;                <span class="hljs-attr">"bufferSize"</span>: <span class="hljs-number">40960</span>            &#125;        &#125;,<span class="hljs-attr">"inbound"</span>: &#123;<span class="hljs-attr">"sniffing"</span>: &#123;<span class="hljs-attr">"enabled"</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">"destOverride"</span>: [<span class="hljs-string">"http"</span>,<span class="hljs-string">"tls"</span>]        &#125;,        <span class="hljs-attr">"udp"</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">"port"</span>:<span class="hljs-number">8883</span> ,<span class="hljs-attr">"listen"</span>:<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"vmess"</span>,<span class="hljs-attr">"settings"</span>: &#123;<span class="hljs-attr">"clients"</span>: [&#123;<span class="hljs-attr">"id"</span>: <span class="hljs-string">"f6707c17-0000-0000-000-000000000"</span>,<span class="hljs-attr">"level"</span>: <span class="hljs-number">1</span>,<span class="hljs-attr">"alterId"</span>: <span class="hljs-number">500</span>,<span class="hljs-attr">"security"</span>: <span class="hljs-string">"auto"</span>                                                               &#125;                                            ]&#125;,<span class="hljs-attr">"streamSettings"</span>:&#123;<span class="hljs-attr">"network"</span>:<span class="hljs-string">"ws"</span>,<span class="hljs-attr">"security"</span>: <span class="hljs-string">"auto"</span>,<span class="hljs-attr">"wsSettings"</span>:&#123;<span class="hljs-attr">"path"</span>: <span class="hljs-string">"/path/"</span>&#125;&#125;,<span class="hljs-attr">"sockopt"</span>: &#123; <span class="hljs-attr">"mark"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"tcpFastOpen"</span>: <span class="hljs-literal">true</span>&#125;,<span class="hljs-attr">"tag"</span>: <span class="hljs-string">"KR"</span>&#125;,<span class="hljs-attr">"inboundDetour"</span>: [          &#123;   <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"dokodemo-door"</span>,   <span class="hljs-attr">"listen"</span>: <span class="hljs-string">"127.0.0.1"</span>,   <span class="hljs-attr">"settings"</span>: &#123;<span class="hljs-attr">"address"</span>: <span class="hljs-string">"127.0.0.1"</span>   &#125;,   <span class="hljs-attr">"port"</span>: <span class="hljs-number">9548</span>,   <span class="hljs-attr">"tag"</span>: <span class="hljs-string">"api"</span>  &#125; ],    <span class="hljs-attr">"outbound"</span>: &#123;        <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"freedom"</span>,        <span class="hljs-attr">"settings"</span>: &#123;&#125;    &#125;,    <span class="hljs-attr">"outboundDetour"</span>: [        &#123;            <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"blackhole"</span>,            <span class="hljs-attr">"settings"</span>: &#123;&#125;,            <span class="hljs-attr">"tag"</span>: <span class="hljs-string">"blocked"</span>        &#125;        ],    <span class="hljs-attr">"dns"</span>: &#123;        <span class="hljs-attr">"servers"</span>: [<span class="hljs-string">"https://dns.google/dns-query"</span>,<span class="hljs-string">"https://1.1.1.1/dns-query"</span>,<span class="hljs-string">"203.248.252.2"</span>,<span class="hljs-string">"164.124.101.2"</span>,        <span class="hljs-string">"127.0.0.1"</span>        ]    &#125;    ,    <span class="hljs-attr">"routing"</span>: &#123;        <span class="hljs-attr">"strategy"</span>: <span class="hljs-string">"rules"</span>,        <span class="hljs-attr">"settings"</span>: &#123;            <span class="hljs-attr">"rules"</span>: [&#123; <span class="hljs-attr">"inboundTag"</span>: [  <span class="hljs-string">"api"</span> ], <span class="hljs-attr">"outboundTag"</span>: <span class="hljs-string">"api"</span>, <span class="hljs-attr">"type"</span>: <span class="hljs-string">"field"</span>&#125;,                &#123;                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"field"</span>,                    <span class="hljs-attr">"outboundTag"</span>: <span class="hljs-string">"block"</span>,                    <span class="hljs-attr">"protocol"</span>: [                      <span class="hljs-string">"bittorrent"</span>                    ]                  &#125;,                &#123;                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"field"</span>,                    <span class="hljs-attr">"ip"</span>: [                        <span class="hljs-string">"0.0.0.0/8"</span>,                        <span class="hljs-string">"10.0.0.0/8"</span>,                        <span class="hljs-string">"100.64.0.0/10"</span>,                        <span class="hljs-string">"127.0.0.0/8"</span>,                        <span class="hljs-string">"169.254.0.0/16"</span>,                        <span class="hljs-string">"172.16.0.0/12"</span>,                        <span class="hljs-string">"192.0.0.0/24"</span>,                        <span class="hljs-string">"192.0.2.0/24"</span>,                        <span class="hljs-string">"192.168.0.0/16"</span>,                        <span class="hljs-string">"198.18.0.0/15"</span>,                        <span class="hljs-string">"198.51.100.0/24"</span>,                        <span class="hljs-string">"203.0.113.0/24"</span>,                        <span class="hljs-string">"::1/128"</span>,                        <span class="hljs-string">"fc00::/7"</span>,                        <span class="hljs-string">"fe80::/10"</span>                    ],                    <span class="hljs-attr">"outboundTag"</span>: <span class="hljs-string">"blocked"</span>                &#125;            ]        &#125;    &#125;&#125;</code></pre></div></li><li><strong>CADDY+ HTTP2 + V2RAY + TLS</strong><div class="hljs"><pre><code class="hljs json">&#123;  <span class="hljs-attr">"inbound"</span>: &#123;    <span class="hljs-attr">"port"</span>: <span class="hljs-number">8883</span>,    <span class="hljs-attr">"listen"</span>: <span class="hljs-string">"127.0.0.1"</span>,    <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"vmess"</span>,    <span class="hljs-attr">"settings"</span>: &#123;      <span class="hljs-attr">"clients"</span>: [        &#123;          <span class="hljs-attr">"id"</span>: <span class="hljs-string">"f6707c17-00000-0000-0000-00000000000"</span>,          <span class="hljs-attr">"level"</span>: <span class="hljs-number">1</span>,          <span class="hljs-attr">"alterId"</span>: <span class="hljs-number">64</span>        &#125;      ]    &#125;,    <span class="hljs-attr">"streamSettings"</span>: &#123;      <span class="hljs-attr">"network"</span>: <span class="hljs-string">"h2"</span>,      <span class="hljs-attr">"security"</span>: <span class="hljs-string">"tls"</span>,      <span class="hljs-attr">"httpSettings"</span>: &#123;        <span class="hljs-attr">"path"</span>: <span class="hljs-string">"/apth"</span>,        <span class="hljs-attr">"host"</span>: <span class="hljs-string">"xxx.com"</span>      &#125;,      <span class="hljs-attr">"tlsSettings"</span>: &#123;        <span class="hljs-attr">"serverName"</span>: <span class="hljs-string">"xxx.com"</span>,        <span class="hljs-attr">"certificates"</span>: [        &#123;          <span class="hljs-attr">"certificateFile"</span>: <span class="hljs-string">"/etc/v2ray/v2ray.crt"</span>,          <span class="hljs-attr">"keyFile"</span>: <span class="hljs-string">"/etc/v2ray/v2ray.key"</span>        &#125;        ]      &#125;    &#125;  &#125;,  <span class="hljs-attr">"outbound"</span>: &#123;    <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"freedom"</span>,    <span class="hljs-attr">"settings"</span>: &#123;&#125;  &#125;,  <span class="hljs-attr">"outboundDetour"</span>: [    &#123;      <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"blackhole"</span>,      <span class="hljs-attr">"settings"</span>: &#123;&#125;,      <span class="hljs-attr">"tag"</span>: <span class="hljs-string">"blocked"</span>    &#125;  ],  <span class="hljs-attr">"routing"</span>: &#123;    <span class="hljs-attr">"strategy"</span>: <span class="hljs-string">"rules"</span>,    <span class="hljs-attr">"settings"</span>: &#123;      <span class="hljs-attr">"rules"</span>: [        &#123;          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"field"</span>,          <span class="hljs-attr">"ip"</span>: [            <span class="hljs-string">"0.0.0.0/8"</span>,            <span class="hljs-string">"10.0.0.0/8"</span>,            <span class="hljs-string">"100.64.0.0/10"</span>,            <span class="hljs-string">"127.0.0.0/8"</span>,            <span class="hljs-string">"169.254.0.0/16"</span>,            <span class="hljs-string">"172.16.0.0/12"</span>,            <span class="hljs-string">"192.0.0.0/24"</span>,            <span class="hljs-string">"192.0.2.0/24"</span>,            <span class="hljs-string">"192.168.0.0/16"</span>,            <span class="hljs-string">"198.18.0.0/15"</span>,            <span class="hljs-string">"198.51.100.0/24"</span>,            <span class="hljs-string">"203.0.113.0/24"</span>,            <span class="hljs-string">"::1/128"</span>,            <span class="hljs-string">"fc00::/7"</span>,            <span class="hljs-string">"fe80::/10"</span>          ],          <span class="hljs-attr">"outboundTag"</span>: <span class="hljs-string">"blocked"</span>        &#125;      ]    &#125;  &#125;&#125;</code></pre></div></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CADDY一键安装脚本及简单配置</title>
    <link href="/2020/d3cb4e9.html"/>
    <url>/2020/d3cb4e9.html</url>
    
    <content type="html"><![CDATA[<h3 id="Caddy-一键安装与配置"><a href="#Caddy-一键安装与配置" class="headerlink" title="Caddy 一键安装与配置"></a>Caddy 一键安装与配置</h3><h4 id="Caddy-一键安装及简单配置"><a href="#Caddy-一键安装及简单配置" class="headerlink" title="Caddy 一键安装及简单配置"></a>Caddy 一键安装及简单配置</h4><h5 id="一键安装"><a href="#一键安装" class="headerlink" title="一键安装"></a>一键安装</h5><div class="hljs"><pre><code class="hljs bash">wget -N --no-check-certificate https://raw.githubusercontent.com/Joyace/sh/master/caddy_install.sh &amp;&amp; chmod +x caddy_install.sh &amp;&amp; bash caddy_install.sh install http.filebrowser<span class="hljs-comment">#备用地址</span>wget -N --no-check-certificate https://www.moerats.com/usr/shell/Caddy/caddy_install.sh &amp;&amp; chmod +x caddy_install.sh &amp;&amp; bash caddy_install.sh</code></pre></div><p>Caddy 使用说明</p><ul><li><p><strong>启动：</strong><code>/etc/init.d/caddy start</code></p></li><li><p><strong>停止：</strong><code>/etc/init.d/caddy stop</code></p></li><li><p><strong>重启：</strong><code>/etc/init.d/caddy restart</code></p></li><li><p><strong>查看状态：</strong><code>/etc/init.d/caddy status</code></p></li><li><p><strong>查看Caddy启动日志：</strong> <code>tail -f /tmp/caddy.log</code></p></li><li><p><strong>安装目录：</strong><code>/usr/local/caddy</code></p></li><li><p><strong>Caddy配置文件位置：</strong><code>/usr/local/caddy/Caddyfile</code></p></li><li><p><strong>Caddy自动申请SSL证书位置：</strong><code>/.caddy/acme/acme-v01.api.letsencrypt.org/sites/xxx.xxx(域名)/</code></p></li></ul><h5 id="配置示范"><a href="#配置示范" class="headerlink" title="配置示范"></a>配置示范</h5><ul><li><strong>CADDY+ HTTP + V2RAY + TLS</strong><div class="hljs"><pre><code class="hljs nginx">http://xxx.com &#123; <span class="hljs-attribute">timeouts</span> <span class="hljs-literal">none</span> redir https://xxx.com&#123;url&#125;&#125;https://xxx.com &#123; <span class="hljs-attribute">root</span> /usr/local/caddy/www/ timeouts <span class="hljs-literal">none</span> tls xxx<span class="hljs-variable">@email</span>.com <span class="hljs-comment">#或者 /path/ca.crt /path/key.key</span> gzip proxy /path/ localhost:<span class="hljs-number">8883</span> &#123;  websocket  <span class="hljs-attribute">header_upstream</span> -Origin  &#125;&#125;</code></pre></div></li><li><strong>CADDY+ HTTP2 + V2RAY + TLS</strong><div class="hljs"><pre><code class="hljs nginx">http://xxx.com &#123;    redir https://xxx.com&#123;url&#125;&#125;https://xxx.com &#123;    <span class="hljs-attribute">root</span> /var/www/    tls xxx<span class="hljs-variable">@email</span>.com <span class="hljs-comment">#或者 /path/ca.crt /path/key.key</span>    proxy /path https://localhost:8883 &#123;        insecure_skip_verify        <span class="hljs-attribute">header_upstream</span> X-Forwarded-Proto <span class="hljs-string">"https"</span>        header_upstream Host <span class="hljs-string">"xxx.com"</span>    &#125;&#125;</code></pre></div></li><li><strong>filebrowser</strong><div class="hljs"><pre><code class="hljs nginx">http://xxx.com &#123; <span class="hljs-attribute">timeouts</span> <span class="hljs-literal">none</span> redir https://xxx.com&#123;url&#125;&#125;xxx.com &#123; <span class="hljs-attribute">root</span> /usr/local/caddy/www/file timeouts <span class="hljs-literal">none</span> tls xxx<span class="hljs-variable">@mail</span>.com gzip filebrowser / /usr/local/caddy/www/file &#123;  <span class="hljs-attribute">database</span> /usr/local/caddy/filebrowser.db &#125;&#125;</code></pre></div></li><li><strong>typecho</strong><div class="hljs"><pre><code class="hljs bash">apt-get install php7.0-cgi php7.0-fpm php7.0-curl php7.0-gd php7.0-mbstring php7.0-xml php7.0-sqlite3 sqlite3 -y</code></pre></div><div class="hljs"><pre><code class="hljs nginx">http://xxx.com &#123;    redir https://xxx.com&#123;url&#125;    &#125;    https://xxx.com &#123;    gzip    <span class="hljs-attribute">tls</span> xxx<span class="hljs-variable">@mail</span>.com    root /typecho    fastcgi / /run/php/php7.<span class="hljs-number">0</span>-fpm.sock php    rewrite &#123;        if &#123;path&#125; not_match ^\/admin        to &#123;path&#125; &#123;path&#125;/ /index.php?&#123;query&#125;     &#125;&#125;</code></pre></div></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hexo默认使用的文章永久链接</title>
    <link href="/2020/ab21860c.html"/>
    <url>/2020/ab21860c.html</url>
    
    <content type="html"><![CDATA[<p>在Hexo博客上添加可爱的Live 2D模型</p><div class="hljs"><pre><code class="hljs bash">npm install --save hexo-helper-live2d</code></pre></div><p>x.安装 hexo-admin，实现网页发布文章:</p><div class="hljs"><pre><code class="hljs bash">npm install --save hexo-admin</code></pre></div><p>然后打开 <a href="http://localhost:4000/admin/" target="_blank" rel="noopener">http://localhost:4000/admin/</a> 就可以看到管理页面</p><p>x. 安装abbrlink插件，在博客根目录（执行hexo命令的地方，解决文件名是中文的问题）安装插件：</p><div class="hljs"><pre><code class="hljs bash">npm install hexo-abbrlink --save</code></pre></div><p>修改 _config.yml 添加：</p><div class="hljs"><pre><code class="hljs yaml"><span class="hljs-comment"># abbrlink config 让文章链接变成随机名字</span><span class="hljs-attr">url:</span> <span class="hljs-string">http://yoursite.com</span><span class="hljs-attr">root:</span> <span class="hljs-string">/</span><span class="hljs-attr">permalink:</span> <span class="hljs-string">:year/:abbrlink.html</span><span class="hljs-attr">permalink_defaults:</span>  <span class="hljs-attr">author_name:</span> <span class="hljs-string">index</span>  <span class="hljs-attr">abbrlink:</span>  <span class="hljs-attr">alg:</span> <span class="hljs-string">crc32</span>  <span class="hljs-comment"># 算法：crc16(default) and crc32</span>  <span class="hljs-attr">rep:</span> <span class="hljs-string">hex</span>    <span class="hljs-comment"># 进制：dec(default) and hex</span></code></pre></div><p>x .让 hexo在后台运行。安装pm2:</p><div class="hljs"><pre><code class="hljs bash">$ npm install -g pm2</code></pre></div><p>写一个执行脚本<br>在博客根目录下面创建一个hexo_run.js</p><div class="hljs"><pre><code class="hljs javascript"><span class="hljs-comment">//run</span><span class="hljs-keyword">const</span> &#123; exec &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>)exec(<span class="hljs-string">'hexo server'</span>,(error, stdout, stderr) =&gt; &#123;        <span class="hljs-keyword">if</span>(error)&#123;                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'exec error: $&#123;error&#125;'</span>)                <span class="hljs-keyword">return</span>        &#125;        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'stdout: $&#123;stdout&#125;'</span>);        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'stderr: $&#123;stderr&#125;'</span>);&#125;)</code></pre></div><p>运行脚本 在根目录下执行:</p><div class="hljs"><pre><code class="hljs bash"><span class="hljs-comment"># pm2 start hexo_run.js</span></code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>V2RAY+WS+TLS的配置(caddy,nginx,apache)</title>
    <link href="/2019/a0b19a80.html"/>
    <url>/2019/a0b19a80.html</url>
    
    <content type="html"><![CDATA[<p>这是 apache 的配置 放到 VirtualHost *:443这个标签里面.</p><p>#使用之前需要在ssh下开启一下模块</p><div class="hljs"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> a2enmod ssl<span class="hljs-attribute">sudo</span> a2enmod proxy<span class="hljs-attribute">sudo</span> a2enmod proxy_wstunnel<span class="hljs-attribute">sudo</span> a2enmod proxy_http<span class="hljs-attribute">sudo</span> a2enmod rewrite<span class="hljs-attribute">sudo</span> a2enmod headers</code></pre></div><p>#Apache配置</p><div class="hljs"><pre><code class="hljs bash">vi /etc/apache2/sites-available/yourdomain.com.conf</code></pre></div><p>#有用的就是下面这一点.复制到你的配置文件里就可以了.开始</p><div class="hljs"><pre><code class="hljs apache"><span class="hljs-section">&lt;VirtualHost *:80&gt;</span>  <span class="hljs-attribute">Redirect</span> /  https://yourdomain.com.tk/<span class="hljs-section">&lt;/VirtualHost&gt;</span><span class="hljs-section">&lt;VirtualHost *:443&gt;</span><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span> yourdomain.com.tk<span class="hljs-comment">#SSL</span><span class="hljs-attribute">SSLEngine</span> <span class="hljs-literal">On</span><span class="hljs-attribute">SSLCertificateFile</span> /etc/letsencrypt/live/yourdomain.com.tk/fullchain.pem<span class="hljs-attribute">SSLCertificateKeyFile</span> /etc/letsencrypt/live/yourdomain.com.tk/privkey.pem<span class="hljs-attribute">SSLCipherSuite</span> EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH<span class="hljs-attribute">SSLProtocol</span> <span class="hljs-literal">All</span> -SSLv2 -SSLv3<span class="hljs-attribute">SSLHonorCipherOrder</span> <span class="hljs-literal">On</span><span class="hljs-attribute"><span class="hljs-nomarkup">Header</span></span> always set Strict-Transport-Security <span class="hljs-string">"max-age=15768000"</span>    <span class="hljs-section">&lt;LocationMatch "/ws"&gt;</span>        <span class="hljs-attribute">ProxyPass</span> ws://127.0.0.1:8883/ws        <span class="hljs-attribute">ProxyAddHeaders</span> <span class="hljs-literal">Off</span>        <span class="hljs-attribute">ProxyPreserveHost</span> <span class="hljs-literal">On</span>        <span class="hljs-attribute">RequestHeader</span> set Host <span class="hljs-variable">%&#123;HTTP_HOST&#125;</span>s        <span class="hljs-attribute">RequestHeader</span> set X-Forwarded-For <span class="hljs-variable">%&#123;REMOTE_ADDR&#125;</span>s  <span class="hljs-section">&lt;/LocationMatch&gt;</span><span class="hljs-section">&lt;/VirtualHost&gt;</span></code></pre></div><p>#结束</p><p>#这是 nginx的配置.</p><div class="hljs"><pre><code class="hljs bash">location /ws &#123;proxy_redirect off;proxy_pass http://127.0.0.1:8883;proxy_http_version 1.1;proxy_set_header Upgrade <span class="hljs-variable">$http_upgrade</span>;proxy_set_header Connection <span class="hljs-string">"upgrade"</span>;proxy_set_header Host <span class="hljs-variable">$http_host</span>;&#125;</code></pre></div><p>#caddy的配置.</p><div class="hljs"><pre><code class="hljs bash">https://yourdomain.com &#123; root /etc/caddy/www timeouts none tls email@xxx.com gzip proxy /ws localhost:8883 &#123;  websocket  header_upstream -Origin  &#125;&#125;</code></pre></div><p>#v2ray服务端配置文件…</p><div class="hljs"><pre><code class="hljs json">&#123;    <span class="hljs-attr">"log"</span>: &#123;            <span class="hljs-attr">"access"</span>: <span class="hljs-string">"/var/log/v2ray/access.log"</span>,            <span class="hljs-attr">"error"</span>: <span class="hljs-string">"/var/log/v2ray/error.log"</span>,            <span class="hljs-attr">"loglevel"</span>: <span class="hljs-string">"warning"</span>    &#125;,    <span class="hljs-attr">"inbound"</span>: &#123;            <span class="hljs-attr">"port"</span>:<span class="hljs-number">8883</span> ,            <span class="hljs-attr">"listen"</span>:<span class="hljs-string">"127.0.0.1"</span>,            <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"vmess"</span>,            <span class="hljs-attr">"settings"</span>: &#123;                    <span class="hljs-attr">"clients"</span>: [&#123;                            <span class="hljs-attr">"id"</span>: <span class="hljs-string">"93e09eb8-004a-0000-0000-00000000000"</span>,                            <span class="hljs-attr">"level"</span>: <span class="hljs-number">1</span>,                            <span class="hljs-attr">"alterId"</span>: <span class="hljs-number">100</span>,                            <span class="hljs-attr">"security"</span>: <span class="hljs-string">"auto"</span>                    &#125;]            &#125;,            <span class="hljs-attr">"streamSettings"</span>:&#123;                    <span class="hljs-attr">"network"</span>:<span class="hljs-string">"ws"</span>,                    <span class="hljs-attr">"security"</span>: <span class="hljs-string">"auto"</span>,                    <span class="hljs-attr">"wsSettings"</span>:&#123;                            <span class="hljs-attr">"path"</span>: <span class="hljs-string">"/ws"</span>                            &#125;                    &#125;    &#125;,    <span class="hljs-attr">"outbound"</span>: &#123;            <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"freedom"</span>,            <span class="hljs-attr">"settings"</span>: &#123;&#125;&#125;</code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>使用SoftEther设置VPN Server</title>
    <link href="/2019/58cf373f.html"/>
    <url>/2019/58cf373f.html</url>
    
    <content type="html"><![CDATA[<h3 id="安装-SoftEther-笔记！"><a href="#安装-SoftEther-笔记！" class="headerlink" title="安装 SoftEther 笔记！"></a>安装 SoftEther 笔记！</h3><a id="more"></a><h6 id="Ubuntu-amp-amp-Debian-使用-SoftEther-VPN-搭建-VPN-Server"><a href="#Ubuntu-amp-amp-Debian-使用-SoftEther-VPN-搭建-VPN-Server" class="headerlink" title="Ubuntu &amp;&amp; Debian 使用 SoftEther VPN  搭建 VPN Server"></a>Ubuntu &amp;&amp; Debian 使用 <a href="https://www.softether.org" target="_blank" rel="noopener">SoftEther VPN</a>  搭建 VPN Server</h6><div class="hljs"><pre><code class="hljs bash"><span class="hljs-comment"># 更新软件包 </span>$ sudo apt-get update &amp;&amp; sudo apt-get upgrade<span class="hljs-comment"># 安装依赖 ubuntu &amp;&amp; debian</span>$ sudo apt-get install build-essential -y<span class="hljs-comment"># 下载服务端</span>wget https://github.com/SoftEtherVPN/SoftEtherVPN_Stable/releases/download/v4.34-9745-beta/softether-vpnserver-v4.34-9745-beta-2020.04.05-linux-x64-64bit.tar.gz<span class="hljs-comment"># 解压 </span>$ tar xzvf softether-vpnserver-v4.34-9745-beta-2020.04.05-linux-x64-64bit.tar.gz<span class="hljs-comment"># 编译</span>$ <span class="hljs-built_in">cd</span> vpnserver$ make<span class="hljs-comment">#编译的过程中会多次提示License Agreement的选择，想用就选Yes（type ‘1’）</span><span class="hljs-comment"># 更改目录位置</span>$ <span class="hljs-built_in">cd</span> ..$ mv vpnserver /usr/<span class="hljs-built_in">local</span>$ <span class="hljs-built_in">cd</span> /usr/<span class="hljs-built_in">local</span>/vpnserver/<span class="hljs-comment"># 更改权限</span>$ sudo chmod 600 *$ sudo chmod 700 vpnserver$ sudo chmod 700 vpncmd<span class="hljs-comment">#开机启动</span>$ vi /etc/rc.local<span class="hljs-comment"># 添加 /usr/local/vpnserver/vpnserver start</span><span class="hljs-comment"># exit 0</span></code></pre></div><h6 id="以上操作就安装完成！"><a href="#以上操作就安装完成！" class="headerlink" title="以上操作就安装完成！"></a>以上操作就安装完成！</h6><div class="hljs"><pre><code class="hljs bash">SoftEther创建问一个service，并配置开机自动启动。首先创建一个文件vim /etc/init.d/vpnserver，将以下内容粘贴进去：<span class="hljs-meta">#!/bin/sh</span><span class="hljs-comment"># chkconfig: 2345 99 01</span><span class="hljs-comment"># description: SoftEther VPN Server</span>DAEMON=/usr/<span class="hljs-built_in">local</span>/vpnserver/vpnserverLOCK=/var/lock/subsys/vpnserver<span class="hljs-built_in">test</span> -x <span class="hljs-variable">$DAEMON</span> || <span class="hljs-built_in">exit</span> 0<span class="hljs-keyword">case</span> <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> <span class="hljs-keyword">in</span>start)    <span class="hljs-variable">$DAEMON</span> start    touch <span class="hljs-variable">$LOCK</span>    ;;stop)    <span class="hljs-variable">$DAEMON</span> stop    rm <span class="hljs-variable">$LOCK</span>    ;;restart)    <span class="hljs-variable">$DAEMON</span> stop    sleep 3    <span class="hljs-variable">$DAEMON</span> start    ;;*)    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage: <span class="hljs-variable">$0</span> &#123;start|stop|restart&#125;"</span>    <span class="hljs-built_in">exit</span> 1<span class="hljs-keyword">esac</span><span class="hljs-built_in">exit</span> 0<span class="hljs-comment"># 如果不存在/var/lock/subsys文件夹，则需要创建一个mkdir /var/lock/subsys。</span><span class="hljs-comment"># 启动</span>$ sudo chmod 755 /etc/init.d/vpnserver &amp;&amp; /etc/init.d/vpnserver start<span class="hljs-comment"># 开机自启动 Debian/Ubuntu</span>$ sudo update-rc.d vpnserver defaults$ <span class="hljs-built_in">cd</span> /var/<span class="hljs-built_in">local</span>/vpnserver/$ ./vpncmd    <span class="hljs-comment"># 选择1 "Management of VPN Server or VPN Bridge"</span>vpncmd&gt;enableRemote</code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ubuntu14.04下部署smokeping监控软件</title>
    <link href="/2019/2aeaaf7a.html"/>
    <url>/2019/2aeaaf7a.html</url>
    
    <content type="html"><![CDATA[<h5 id="Ubuntu-部署-Smokeping-监控软件"><a href="#Ubuntu-部署-Smokeping-监控软件" class="headerlink" title="Ubuntu 部署 Smokeping 监控软件"></a><strong>Ubuntu</strong> 部署 <strong>Smokeping</strong> 监控软件</h5><a id="more"></a><p>1.安装smokeping软件</p><div class="hljs"><pre><code class="hljs bash">sudo apt-get install smokeping -y</code></pre></div><p>2.编辑smokeping配置文件，不发送报警邮件。如有需要，可以后续添加。</p><div class="hljs"><pre><code class="hljs bash">sudo vi /etc/smokeping/config.d/pathnames<span class="hljs-comment">#注释掉这行</span><span class="hljs-comment">#sendmail = /usr/sbin/sendmail</span><span class="hljs-comment">#编辑 General 修改your-ip为服务器IP</span>sudo vi /etc/smokeping/config.d/Generalcgiurl = http://your-ip/cgi-bin/smokeping.cgi</code></pre></div><p>3.编辑apache配置文件。</p><div class="hljs"><pre><code class="hljs bash">sudo vim /etc/apache2/conf-available/serve-cgi-bin.conf</code></pre></div><div class="hljs"><pre><code class="hljs apache"><span class="hljs-section">&lt;IfModule mod_alias.c&gt;</span>        <span class="hljs-section">&lt;IfModule mod_cgi.c&gt;</span>                <span class="hljs-attribute">Define</span> ENABLE_USR_LIB_CGI_BIN        <span class="hljs-section">&lt;/IfModule&gt;</span>        <span class="hljs-section">&lt;IfModule mod_cgid.c&gt;</span>                <span class="hljs-attribute">Define</span> ENABLE_USR_LIB_CGI_BIN        <span class="hljs-section">&lt;/IfModule&gt;</span>        <span class="hljs-section">&lt;IfDefine ENABLE_USR_LIB_CGI_BIN&gt;</span>                <span class="hljs-attribute">ScriptAlias</span> /cgi-bin/ /usr/lib/cgi-bin/                <span class="hljs-section">&lt;Directory "/usr/lib/cgi-bin"&gt;</span>                        <span class="hljs-attribute">AllowOverride</span> None                        <span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span> +ExecCGI -MultiViews +SymLinksIfOwnerMatch                        <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted                 <span class="hljs-section">&lt;/Directory&gt;</span>                        <span class="hljs-attribute">ScriptAlias</span> /smokeping/smokeping.cgi /usr/lib/cgi-bin/smokeping.cgi                        <span class="hljs-attribute">Alias</span> /smokeping /usr/share/smokeping/www                 <span class="hljs-section">&lt;Directory “/usr/share/smokeping/www”&gt;</span>                        <span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span> FollowSymLinks                <span class="hljs-section">&lt;/Directory&gt;</span>        <span class="hljs-section">&lt;/IfDefine&gt;</span><span class="hljs-section">&lt;/IfModule&gt;</span><span class="hljs-comment">#vim: syntax=apache ts=4 sw=4 sts=4 sr noet</span></code></pre></div><p>4.重启cgi,apache,smokeping</p><div class="hljs"><pre><code class="hljs bash">sudo a2enmod cgisudo service apache2 restartsudo service smokeping restart</code></pre></div><h5 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h5><h6 id="排错指南："><a href="#排错指南：" class="headerlink" title="排错指南："></a>排错指南：</h6><p><strong>一.</strong> 当apache2重启提示：</p><div class="hljs"><pre><code class="hljs bash">* Starting web server apache2   apache2: Could not reliably determine the server<span class="hljs-string">'s fully qualified domain name, </span><span class="hljs-string">... waiting apache2: Could not reliably determine the server'</span>s fully qualified domain name, using 127.0.1.1 <span class="hljs-keyword">for</span> ServerName</code></pre></div><p>解决的问题是：</p><div class="hljs"><pre><code class="hljs bash">sudo vi /etc/apache2/sites-available/default<span class="hljs-comment">#打开default文件后，在default文件顶端加入：</span>ServerName 127.0.0.1<span class="hljs-comment">#重启apache2 就不会提示上述错误了</span></code></pre></div><p><strong>二.</strong> 修改apache2的默认端口，默认网站目录和默认主页文档</p><div class="hljs"><pre><code class="hljs bash">1. 修改 /etc/apache2/ports.conf 将NameVirtualHost *:80Listen 80改为自己需要的端口NameVirtualHost *:9000Listen 90002，修改/etc/apache2/sites-available/default 将第一行的&lt;VirtualHost *:80&gt; 改为自己需要的端口 &lt;VirtualHost *:9000&gt;3，修改 /etc/init.d/apache2/httpd.conf 添加Servername localhost否则重启时会报如下错误 * Restarting web server apache2                                                 apache2: Could not reliably determine the server<span class="hljs-string">'s fully qualified domain name, using 127.0.1.1 for ServerName</span><span class="hljs-string"> ... waiting apache2: Could not reliably determine the server'</span>s fully qualified domain name, using 127.0.1.1 <span class="hljs-keyword">for</span> ServerName                                                                         4，重启apachesudo /etc/init.d/apache2 restart端口修改完毕。apache的端口修改为9000了。<span class="hljs-comment">###########################################</span>修改默认网站目录：/etc/apache2/sites-available/default 将/var/www 修改位你的路径: /var/www/GMG/修改默认主页文档：/etc/apache2/mods-available/dir.conf将 index.* 替换为 xxx.* 不过随apache2的版本不同 文件的放置位置不一样  输入这个命令 grep -iR DirectoryIndex /etc/apache2查看 DirectoryIndex 在apache2哪个文件里面。</code></pre></div>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>腾讯云服务器使用v2ray搭建socks代理及跳墙中转</title>
    <link href="/2019/4be3197a.html"/>
    <url>/2019/4be3197a.html</url>
    
    <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>Linux下搭建socks透明代理，通常都是使用dante。不过鉴于我们还有其他需求（跳墙中转），所以我们选择了使用最近比较热门的v2ray程序。</p><a id="more"></a><div class="hljs"><pre><code class="hljs plain">&#123;  &quot;log&quot; : &#123;    &quot;access&quot;: &quot;&#x2F;var&#x2F;log&#x2F;v2ray&#x2F;access.log&quot;,    &quot;error&quot;: &quot;&#x2F;var&#x2F;log&#x2F;v2ray&#x2F;error.log&quot;,    &quot;loglevel&quot;: &quot;warning&quot;  &#125;,  &quot;inbound&quot;: &#123;    &quot;port&quot;: 8866,    &quot;listen&quot;: &quot;0.0.0.0&quot;,    &quot;protocol&quot;: &quot;socks&quot;,    &quot;settings&quot;: &#123;      &quot;auth&quot;: &quot;password&quot;,      &quot;accounts&quot;: [        &#123;          &quot;user&quot;: &quot;my-socks&quot;,          &quot;pass&quot;: &quot;my-password&quot;        &#125;      ],      &quot;udp&quot;: true,      &quot;ip&quot;: &quot;腾讯云内网IP地址&quot;    &#125;,    &quot;tag&quot;: &quot;socks-in&quot;  &#125;,  &quot;outbound&quot;: &#123;    &quot;protocol&quot;: &quot;shadowsocks&quot;,    &quot;settings&quot;: &#123;      &quot;servers&quot;: [        &#123;          &quot;email&quot;: &quot;ss2@v2ray.com&quot;,          &quot;address&quot;: &quot;225.255.255.255&quot;,          &quot;port&quot;: 6656,          &quot;method&quot;: &quot;aes-256-cfb&quot;,          &quot;password&quot;: &quot;my-password&quot;,          &quot;ota&quot;: false        &#125;      ]    &#125;,    &quot;tag&quot;: &quot;ss-out&quot;  &#125;,  &quot;inboundDetour&quot;: [    &#123;      &quot;port&quot;: 8800,      &quot;listen&quot;: &quot;0.0.0.0&quot;,      &quot;protocol&quot;: &quot;vmess&quot;,      &quot;settings&quot;: &#123;        &quot;clients&quot;: [          &#123;            &quot;id&quot;: &quot;4119f123-3863-4d3e-aaf6-379fdda3a371&quot;,            &quot;level&quot;: 1,            &quot;alterId&quot;: 64,            &quot;email&quot;: &quot;vmess@v2ray.com&quot;          &#125;        ]      &#125;,      &quot;tag&quot;: &quot;v2ray-in&quot;    &#125;,    &#123;      &quot;port&quot;: 8899,      &quot;listen&quot;: &quot;0.0.0.0&quot;,      &quot;protocol&quot;: &quot;shadowsocks&quot;,      &quot;settings&quot;: &#123;        &quot;email&quot;: &quot;ss1@v2ray.com&quot;,        &quot;method&quot;: &quot;aes-256-cfb&quot;,        &quot;password&quot;: &quot;my-password&quot;,        &quot;udp&quot;: true,        &quot;level&quot;: 0,        &quot;ota&quot;: false      &#125;,      &quot;tag&quot;: &quot;ss-in&quot;    &#125;  ],  &quot;outboundDetour&quot;: [    &#123;      &quot;protocol&quot;: &quot;freedom&quot;,      &quot;settings&quot;: &#123;&#125;,      &quot;tag&quot;: &quot;direct&quot;    &#125;,    &#123;      &quot;protocol&quot;: &quot;blackhole&quot;,      &quot;settings&quot;: &#123;&#125;,      &quot;tag&quot;: &quot;blocked&quot;    &#125;,    &#123;      &quot;protocol&quot;: &quot;vmess&quot;,      &quot;settings&quot;: &#123;        &quot;vnext&quot;: [          &#123;            &quot;address&quot;: &quot;v2ray.cool&quot;,            &quot;port&quot;: 10086,            &quot;users&quot;: [              &#123;                &quot;id&quot;: &quot;a3482e88-686a-4a58-8126-99c9df64b7bf&quot;,                &quot;alterId&quot;: 64,                &quot;security&quot;: &quot;auto&quot;              &#125;            ]          &#125;        ]      &#125;,      &quot;mux&quot;: &#123;        &quot;enabled&quot;: true      &#125;,      &quot;tag&quot;: &quot;v2ray-out&quot;    &#125;  ],  &quot;dns&quot;: &#123;    &quot;servers&quot;: [      &quot;114.114.114.114&quot;,      &quot;114.114.115.115&quot;,      &quot;localhost&quot;    ]  &#125;,  &quot;routing&quot;: &#123;    &quot;strategy&quot;: &quot;rules&quot;,    &quot;settings&quot;: &#123;      &quot;domainStrategy&quot;: &quot;IPIfNonMatch&quot;,      &quot;rules&quot;: [        &#123;          &quot;type&quot;: &quot;field&quot;,          &quot;ip&quot;: [            &quot;0.0.0.0&#x2F;8&quot;,            &quot;10.0.0.0&#x2F;8&quot;,            &quot;100.64.0.0&#x2F;10&quot;,            &quot;127.0.0.0&#x2F;8&quot;,            &quot;169.254.0.0&#x2F;16&quot;,            &quot;172.16.0.0&#x2F;12&quot;,            &quot;192.0.0.0&#x2F;24&quot;,            &quot;192.0.2.0&#x2F;24&quot;,            &quot;192.168.0.0&#x2F;16&quot;,            &quot;198.18.0.0&#x2F;15&quot;,            &quot;198.51.100.0&#x2F;24&quot;,            &quot;203.0.113.0&#x2F;24&quot;,            &quot;::1&#x2F;128&quot;,            &quot;fc00::&#x2F;7&quot;,            &quot;fe80::&#x2F;10&quot;          ],          &quot;outboundTag&quot;: &quot;blocked&quot;        &#125;,        &#123;          &quot;type&quot;: &quot;field&quot;,          &quot;inboundTag&quot;: [            &quot;ss-in&quot;          ],          &quot;outboundTag&quot;: &quot;ss-out&quot;        &#125;,        &#123;          &quot;type&quot;: &quot;field&quot;,          &quot;domain&quot;: [            &quot;baidu.com&quot;,            &quot;qq.com&quot;          ],          &quot;outboundTag&quot;: &quot;direct&quot;        &#125;,        &#123;          &quot;type&quot;: &quot;chinaip&quot;,          &quot;outboundTag&quot;: &quot;direct&quot;        &#125;,        &#123;          &quot;type&quot;: &quot;chinasites&quot;,          &quot;outboundTag&quot;: &quot;direct&quot;        &#125;      ]    &#125;  &#125;&#125;</code></pre></div><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>申请Let’s Encrypt通配符HTTPS证书</title>
    <link href="/2019/664256ae.html"/>
    <url>/2019/664256ae.html</url>
    
    <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>Let’s Encrypt 发布的 ACME v2 现已正式支持通配符证书，接下来将为大家介绍怎样申请，Let’s go.</p><a id="more"></a><p>Let’s Encrypt 发布的 ACME v2 现已正式支持通配符证书，接下来将为大家介绍怎样申请，Let’s go.</p><p>注 本教程是在centos 7下操作的，其他Linux系统大同小异。</p><p>2018.03.15 20:48 更新了通过acme.sh方式获取证书的方法，墙裂推荐这种方法</p><p>一、acme.sh的方式<br>1.获取acme.sh</p><div class="hljs"><pre><code class="hljs plain">curl https:&#x2F;&#x2F;get.acme.sh | sh</code></pre></div><p>如下所示安装成功</p><p>image</p><p>注：我在centos 7上遇到问题，安装完后执行acme.sh，提示命令没找到，如果遇到跟我一样的问题，请再执行以下指令：</p><div class="hljs"><pre><code class="hljs plain">source ~&#x2F;.bashrc</code></pre></div><p>2.开始获取证书<br>acme.sh强大之处在于，可以自动配置DNS，不用去域名后台操作解析记录了，我的域名是在阿里注册的，下面给出阿里云解析的例子，其他地方注册的请参考这里自行修改：传送门</p><p>请先前往阿里云后台获取App_Key跟App_Secret 传送门，然后执行以下脚本</p><div class="hljs"><pre><code class="hljs plain"># 替换成从阿里云后台获取的密钥export Ali_Key&#x3D;&quot;sdfsdfsdfljlbjkljlkjsdfoiwje&quot;export Ali_Secret&#x3D;&quot;jlsdflanljkljlfdsaklkjflsa&quot;# 换成自己的域名acme.sh --issue --dns dns_ali -d zhuziyu.cn -d *.zhuziyu.cn这里是通过线程休眠120秒等待DNS生效的方式，所以至少需要等待两分钟</code></pre></div><p>到了这一步大功告成，撒花</p><p>acme.sh比certbot的方式更加自动化，省去了手动去域名后台改DNS记录的步骤，而且不用依赖Python，墙裂推荐😄</p><p>第一次成功之后，acme.sh会记录下App_Key跟App_Secret，并且生成一个定时任务，每天凌晨0：00自动检测过期域名并且自动续期。对这种方式有顾虑的，请慎重，不过也可以自行删掉用户级的定时任务，并且清理掉~/.acme.sh文件夹就行</p><p>二、 certbot方式获取证书[不推荐]<br>1.获取certbot-auto</p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><div class="hljs"><pre><code class="hljs plain">wget https:&#x2F;&#x2F;dl.eff.org&#x2F;certbot-auto# 设为可执行权限chmod a+x certbot-auto</code></pre></div><p>2.开始申请证书</p><div class="hljs"><pre><code class="hljs plain"># 注xxx.com请根据自己的域名自行更改.&#x2F;certbot-auto --server https:&#x2F;&#x2F;acme-v02.api.letsencrypt.org&#x2F;directory -d &quot;*.xxx.com&quot; --manual --preferred-challenges dns-01 certonly</code></pre></div><p>执行完这一步之后，会下载一些需要的依赖，稍等片刻之后，会提示输入邮箱，随便输入都行【该邮箱用于安全提醒以及续期提醒】</p><p>注意，申请通配符证书是要经过DNS认证的，按照提示，前往域名后台添加对应的DNS TXT记录。添加之后，不要心急着按回车，先执行dig xxxx.xxx.com txt确认解析记录是否生效，生效之后再回去按回车确认</p><p>到了这一步后，大功告成！！！ 证书存放在/etc/letsencrypt/live/xxx.com/里面</p><p>要续期的话，执行certbot-auto renew就可以了</p><p>注：经评论区 ddatsh 的指点，这样的证书无法应用到主域名xxx.com上，如需把主域名也增加到证书的覆盖范围，请在开始申请证书步骤的那个指令把主域名也加上，如下： 需要注意的是，这样的话需要修改两次解析记录</p><div class="hljs"><pre><code class="hljs plain">.&#x2F;certbot-auto --server https:&#x2F;&#x2F;acme-v02.api.letsencrypt.org&#x2F;directory -d &quot;*.xxx.com&quot; -d &quot;xxx.com&quot; --manual --preferred-challenges dns-01 certonly</code></pre></div><p>下面是一个nginx应用该证书的一个例子</p><div class="hljs"><pre><code class="hljs plain">server &#123;    server_name xxx.com;    listen 443 http2 ssl;    ssl on;    ssl_certificate &#x2F;etc&#x2F;cert&#x2F;xxx.cn&#x2F;fullchain.pem;    ssl_certificate_key &#x2F;etc&#x2F;cert&#x2F;xxx.cn&#x2F;privkey.pem;    ssl_trusted_certificate  &#x2F;etc&#x2F;cert&#x2F;xxx.cn&#x2F;chain.pem;    location &#x2F; &#123;      proxy_pass http:&#x2F;&#x2F;127.0.0.1:6666;    &#125;&#125;</code></pre></div><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ocserv 安装记录</title>
    <link href="/2019/c4135fb1.html"/>
    <url>/2019/c4135fb1.html</url>
    
    <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>ocserv 安装记录</p><a id="more"></a><p>ocserv 全称是 OpenConnect VPN Server。实现了 AnyConnect SSL VPN 协议，兼容 OpenConnection VPN 客户端。特点是体积小、安全和可配置。依赖标准协议如 TLS 1.2 和数据报文 TLS。</p><p>它通过实现Cisco的AnyConnect协议，用DTLS作为主要的加密传输协议。</p><p>开启内核ipv4转发</p><div class="hljs"><pre><code class="hljs plain">vim &#x2F;etc&#x2F;sysctl.conf将net.ipv4.ip_forward 设置为1net.ipv4.ip_forward &#x3D; 1保存执行 sysctl -p 添加防火墙流量转发(网卡名称以实际情况为准)iptables -t nat -A POSTROUTING -s 172.16.200.0&#x2F;24 -o eth0 -j MASQUERADEiptables -A FORWARD -s 172.16.200.0&#x2F;24 -j ACCEPTservice iptables save</code></pre></div><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Softether VPNClient Linux端配置及加入VPNServer过程</title>
    <link href="/2019/2ac27b95.html"/>
    <url>/2019/2ac27b95.html</url>
    
    <content type="html"><![CDATA[<p>准备重写！2222</p>]]></content>
    
    
    <categories>
      
      <category>日常笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VPN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntu修改时区和更新时间</title>
    <link href="/2019/5b532a6f.html"/>
    <url>/2019/5b532a6f.html</url>
    
    <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><center>Ubuntu修改时区和更新时间.</center><a id="more"></a><p>Ubuntu修改时区和更新时间<br>先查看当前系统时间</p><div class="hljs"><pre><code class="hljs plain">root@ubuntu:&#x2F;# date -R</code></pre></div><p>结果时区是：-0500<br>我需要的是东八区，这儿显示不是，所以需要设置一个时区</p><p>1.运行tzselect</p><div class="hljs"><pre><code class="hljs plain">root@ubuntu:&#x2F;# tzselect</code></pre></div><p>在这里我们选择亚洲 Asia，确认之后选择中国（China)，最后选择北京(Beijing)</p><p>2.复制文件到/etc目录下</p><div class="hljs"><pre><code class="hljs plain">root@ubuntu:&#x2F;# cp &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F;Asia&#x2F;Shanghai  &#x2F;etc&#x2F;localtime</code></pre></div><p>3.再次查看时间date -R，已经修改为北京时间</p><p>改时间参考<br>修改时间</p><div class="hljs"><pre><code class="hljs plain">sudo date -s MM&#x2F;DD&#x2F;YY &#x2F;&#x2F;修改日期sudo date -s hh:mm:ss &#x2F;&#x2F;修改时间</code></pre></div><p>在修改时间以后，修改硬件CMOS的时间</p><div class="hljs"><pre><code class="hljs plain">sudo hwclock --systohc &#x2F;&#x2F;非常重要，如果没有这一步的话，后面时间还是不准</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>日常笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VPN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>升级 Ubuntu，解决登录时提示有软件包可以更新的问题</title>
    <link href="/2019/4bd2725e.html"/>
    <url>/2019/4bd2725e.html</url>
    
    <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><center>升级 Ubuntu，解决登录时提示有软件包可以更新的问题。</center><a id="more"></a><p>Welcome to Ubuntu 14.04.2 LTS (GNU/Linux 3.13.0–48-generic x86_64)</p><ul><li>Documentation: <a href="https://help.ubuntu.com/" target="_blank" rel="noopener">https://help.ubuntu.com/</a> System information as of Sat Jun 27 01:12:04 UTC 2015 System load: 0.0 Processes: 98 Usage of /: 10.6% of 9.71GB Users logged in: 0 Memory usage: 10% IP address for eth0: 192.168.12.233 Swap usage: 0%<br>Graph this data and manage this system at:<br><a href="https://landscape.canonical.com/" target="_blank" rel="noopener">https://landscape.canonical.com/</a> Get cloud support with Ubuntu Advantage Cloud Guest:<br><a href="http://www.ubuntu.com/business/services/cloud" target="_blank" rel="noopener">http://www.ubuntu.com/business/services/cloud</a> 91 packages can be updated. 39 updates are security updates.</li></ul><p>对于一般的更新，如果不影响使用，一般也就罢了。但是通常，如果系统提示有安全更新，大多数用户（特别是服务器管理员）还是会去更新的。不过，面对 Ubuntu 的这些提示，很多用户经常遇到「不管怎么apt-get updage &amp;&amp; apt-get upgrade也不见好」的问题。</p><p>升级命令<br>虽然 apt-get 经常被人诟病，但实际上它还是个挺好用的软件包管理器。在 Ubuntu 14.04 以后的系统中，apt-get 相关的升级更新命令有四个：</p><div class="hljs"><pre><code class="hljs plain">#####从服务器更新可用的软件包列表。update 根据列表，更新已安装的软件包。upgrade不会删除在列表中已经没有的软件包，也不会安装有依赖需求但尚未安装的软件包。#####upgrade 根据列表，更新已安装的软件包。full-upgrade可能会为了解决软件包冲突而删除一些已安装的软件包。#####apt-get full–upgrade根据列表，更新已安装的软件包。dist-upgrade可能会为了解决软件包冲突而删除一些已安装的软件包，也可能会为了解决软件包依赖问题安装新的软件包。#####dist-upgrade</code></pre></div><p>#####我们应该怎么做？依次执行如下命令即可：</p><div class="hljs"><pre><code class="hljs plain">apt-get update apt-get upgrade apt-get dist-upgraderebootapt-get update &amp;&amp; apt-get upgrade &amp;&amp; apt-get dist-upgrade</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>日常笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VPN</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
